<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IPO Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="manage-ipo.css"/>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <nav class="col-md-2 d-md-block sidebar position-fixed">
        <div class="sidebar-header p-3 d-flex align-items-center">
          <img src="Bluestock Fintech Logo.png" alt="Bluestock Fintech Logo" class="sidebar-logo">
          <h3 class="ms-2 mb-0 company-name">Bluestock Fintech</h3>
        </div>                
        <div class="p-3">
          <h5 class="text-uppercase">Menu</h5>
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="visual-dashboard.html"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="manage-ipo.html"><i class="bi bi-bar-chart"></i> Manage IPO</a></li>
            <li class="nav-item"><a class="nav-link" href="register-ipo.html"><i class="bi bi-calendar-check"></i> IPO Registration</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-cash-coin"></i> IPO Allotment</a></li>
          </ul>
          <hr class="bg-light">
          <h5 class="text-uppercase">Others</h5>
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-gear"></i> Settings</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-code-slash"></i> API Manager</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-person"></i> Accounts</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-question-circle"></i> Help</a></li>
          </ul>
        </div>
      </nav>

      <!-- Main Content -->
      <main class="col-md-10 offset-md-2 ms-sm-auto px-md-4 py-4">
        <!-- Topbar -->
        <div class="topbar d-flex justify-content-between align-items-center mb-4">
          <div class="input-group w-25">
            <input type="text" class="form-control" placeholder="Search IPOs...">
            <span class="input-group-text"><i class="bi bi-search"></i></span>
          </div>
          <div class="d-flex align-items-center">
            <img src="notif-icon.jpg" alt="Notifications" class="me-3 notification-icon">
            <div class="user-info d-flex align-items-center">
              <span class="me-2">Hi, Vishal</span>
              <img src="user-icon.png" alt="User" class="user-img">
            </div>
            <button class="btn btn-sm btn-outline-secondary ms-3" onclick="toggleDarkMode()" id="darkToggle">
  <img src="moon.png" alt="Dark Mode" width="20" height="20" />
</button>

          </div>
        </div>

        <!-- IPO Details Card -->
        <div class="card p-4 shadow-sm">
          <div class="d-flex align-items-center mb-4">
            <img id="companyLogo" src="logo.jpg" alt="Company Logo" style="width: 50px; height: 50px; object-fit: contain; border: 1px solid #ccc; border-radius: 6px; margin-right: 15px;">
            <h2 id="companyName" class="mb-0">IPO Details</h2>
          </div>

          <form>
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Price Band</label>
                <input type="text" class="form-control" id="priceBand" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Issue Size</label>
                <input type="text" class="form-control" id="issueSize" readonly>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Open Date</label>
                <input type="text" class="form-control" id="open" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Close Date</label>
                <input type="text" class="form-control" id="close" readonly>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Issue Type</label>
                <input type="text" class="form-control" id="issueType" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Listing Date</label>
                <input type="text" class="form-control" id="listingDate" readonly>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Status</label>
              <input type="text" class="form-control" id="status" readonly>
            </div>

            <hr class="my-4"/>

            <h4 class="mb-3"></h4>
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">IPO Price</label>
                <input type="text" class="form-control" id="ipoPrice" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Listing Price</label>
                <input type="text" class="form-control" id="listingPrice" readonly>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">Listing Gain</label>
                <input type="text" class="form-control" id="listingGain" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Current Return</label>
                <input type="text" class="form-control" id="currentReturn" readonly>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label">CMP</label>
                <input type="text" class="form-control" id="cmp" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">RHP PDF</label>
                <input type="text" class="form-control" id="rhp" readonly>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">DRHP PDF</label>
              <input type="text" class="form-control" id="drhp" readonly>
            </div>
          </form>

          <a href="manage-ipo.html" class="btn btn-secondary mt-4">‚Üê Back to Dashboard</a>
        </div>
      </main>
    </div>
  </div>

  <script>
   document.addEventListener("DOMContentLoaded", async () => {
  const params = new URLSearchParams(window.location.search);
  const slug = params.get("id");

  if (!slug) return;

  try {
    const res = await fetch(`/ipos/company/${slug}`);
    if (!res.ok) throw new Error("IPO not found");
    const ipo = await res.json();

    // Basic IPO details
    document.getElementById("companyName").innerText = ipo.company;
    document.getElementById("priceBand").innerText = ipo.priceBand;
    document.getElementById("open").innerText = ipo.open;
    document.getElementById("close").innerText = ipo.close;
    document.getElementById("issueSize").innerText = ipo.issueSize;
    document.getElementById("issueType").innerText = ipo.issueType;
    document.getElementById("listingDate").innerText = ipo.listingDate;
    document.getElementById("status").innerText = ipo.status;

    // Extended listing info
    document.getElementById("ipoPrice").innerText = ipo.ipoPrice || "-";
    document.getElementById("listingPrice").innerText = ipo.listingPrice || "-";
    document.getElementById("listingGain").innerText = ipo.listingGain || "-";
    document.getElementById("cmp").innerText = ipo.cmp || "-";
    document.getElementById("currentReturn").innerText = ipo.currentReturn || "-";
    document.getElementById("rhp").innerText = ipo.rhp || "-";
    document.getElementById("drhp").innerText = ipo.drhp || "-";

    // Company Logo
    if (ipo.logo) {
      document.getElementById("companyLogo").src = ipo.logo;
    }

  } catch (error) {
    console.error("Error loading IPO data:", error);
    document.querySelector("form")?.replaceWith(
      document.createElement("h4")
    ).innerText = "Error loading IPO data";
  }
});

  </script>
</body>
</html>
